---
output: 
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    number_sections: yes
geometry: margin=2.54cm
title: "Insert title of project here"
subtitle: "https://github.com/mullja21/Mullens_Chang_Jenkins_872_EDA_Final.git"
author: "Irene Chang, Susanna Jenkins, and Jordan Mullens"
fontsize: 12pt
mainfont: Times New Roman

---

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set your working directory
getwd()
setwd("/home/guest/Mullens_Chang_Jenkins_Final")

#install package
#install.packages("janitor")

# Load your packages
library(tidyverse)
library(agricolae)
library(ggplot2)
library(lubridate)
library(janitor)

# Set your ggplot theme
library(ggthemes)
our_theme <- theme_base() +
  theme(
    line = element_line(
      color= 'black',
      linewidth = 2),
    legend.background = element_rect(
      color = "lightgrey",
      fill = "lightgrey"),
    legend.title = element_text (
      color = "blue"))
theme_set(our_theme)


# Load your datasets
RDD.raw <- read.csv("./Public_RDD_Spending_All_Countries.csv")

```


# Rationale and Research Questions
Question 1: Was public investment in lower carbon energy RD&D significant during the Obama administration?


\newpage

# Dataset Information
The dataset utilized in this analysis were downloaded from International Energy Agency. The IEA's Energy Technology RD&D Budgets database provides spending information by energy technology in IEA countries from 1974 to 2022. Data is collected from central or federal government budgets and state-owned companies. Spending categories encompass renewables, nuclear power, fossil fuels, hydrogen, fuel cells, and energy efficiency.


\newpage

# Exploration of Raw Data 

```{r dataset info}
#checking the original data set dimensions before wrangling. View dimensions, cloumn names, variable type, and head of each column.

dim(RDD.raw)
summary(RDD.raw)


```

# Data Wrangling
Downloaded the Energy Technology RD&D Budgets. After importing the data to GitHub and Rstudio, the raw dataset was wrangled to suit our analysis. A new data frame was created by extracting the desired years (1985-2015), currency (USD 2021 prices and exchange rates), and economic indications (total, fossil fuels and unallocated) for each country. A variable for year over year percentage (YOY) difference was created to normalize all comparisons. 

```{r dataset wrangling}
#create new data frame, change column names
RDD.newcolnames <- RDD.raw %>%
  row_to_names(row_number = 1)

#the column names were imported improperly. The first row contains the correct column names, so we used the janitor package since they have a function that will replace the column names with the first row.

 

RDD.countries <-
  filter(RDD.newcolnames,
         Country == "Germany" | Country == "United States",
         Currency == "USD (2021 prices and exchange rates)") %>%
  rename("Economic.Indicators" = "Economic Indicators")


RDD.final <- RDD.countries %>%
  filter(Economic.Indicators == "Total Budget" | Economic.Indicators == "Unallocated " | Economic.Indicators == "Fossil fuels") %>%
  select("Country", "Currency", "Economic.Indicators", "1985", "1986", "1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015")

RDD.transpose <- data.frame(t(RDD.final))

#In our final data frame, we want each year to have its own row but in the original dataset that we had, each year was a column. We transposed it.

colnames(RDD.transpose) <- c("Germany.FossilFuels", "Germany.Unallocated", "Germany.TotalBudget", "US.FossilFuels", "US.Unallocated", "US.TotalBudget")

RDD.transpose.rows <- RDD.transpose[!(row.names(RDD.transpose) %in% c("Country", "Currency", "Economic.Indicators")),]

 
RDD.transpose.rows <- RDD.transpose.rows %>%
  mutate_at(1:6, as.numeric)

#creating frame for US Data
RDD.US <- data.frame(Year=c("1985", "1986", "1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015"), 
                     Fossil.Fuel= RDD.transpose.rows$US.FossilFuels,
                     Unallocated= RDD.transpose.rows$US.Unallocated,
                     Total.Budget= RDD.transpose.rows$US.TotalBudget) %>%
  mutate(Low.Carbon.Energy = Total.Budget-Fossil.Fuel-Unallocated) %>%
  mutate(Percent.Change = ((Low.Carbon.Energy -
                              lag(Low.Carbon.Energy))/lag(Low.Carbon.Energy))*100) %>%
  mutate(Country = "US")


#creating frame for Germany Data
RDD.Germany <- data.frame(Year=c("1985", "1986", "1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015"),
                          Fossil.Fuel= RDD.transpose.rows$Germany.FossilFuels,
                          Unallocated= RDD.transpose.rows$Germany.Unallocated,
                          Total.Budget= RDD.transpose.rows$Germany.TotalBudget) %>%
  mutate(Low.Carbon.Energy = Total.Budget-Fossil.Fuel-Unallocated) %>%
  mutate(Percent.Change = ((Low.Carbon.Energy -
                              lag(Low.Carbon.Energy))/lag(Low.Carbon.Energy))*100) %>%
  mutate(Country = "Germany")

```


\newpage

# Analysis
The analysis of this dataset focused on comparing the mean investment YOY difference of the Pre-Obama era and the mean investment YOY difference of the Obama era. However, we need to ensure any changes in investment is unique to the Obama administration and not occuring globally. Therefore, we will also utilize t-tests to compare US investments to Germany's within the same time period.

```{r visualizing the data}
US.and.Germany.RDD <- rbind(RDD.Germany, RDD.US)


#plotting the data
US.Germany.RDD.plot <- ggplot(US.and.Germany.RDD,
    aes(x= Year,
    y= Percent.Change, 
    color= Country)) + 
  geom_smooth() +
  geom_point() +
  labs(title = "Year over year percent \n change in low carbon RDD",
       y="Year over year percent change",
       x="Year") + 
  our_theme +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
  
print(US.Germany.RDD.plot)
  

```




```{r conducting 3 ttests}


```



## Question 1: <insert specific question here and add additional subsections for additional questions below, if needed>

## Question 2: 




\newpage

# Summary and Conclusions


\newpage

# References
<add references here if relevant, otherwise delete this section> 
